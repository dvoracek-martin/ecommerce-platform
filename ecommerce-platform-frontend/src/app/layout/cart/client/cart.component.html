<div class="cart-container" *ngIf="cart">

  <h1>Your Shopping Cart</h1>

  <div *ngIf="!cartItemsWithProducts.length" class="empty-cart">
    <p>Your cart is empty ðŸ˜¢</p>
  </div>

  <div class="cart-items" *ngIf="cartItemsWithProducts.length">
    <div *ngFor="let item of cartItemsWithProducts" class="cart-item">

      <div class="item-media" (click)="goToProduct(item.itemId)">
        <img *ngIf="item.product?.media?.length"
             [src]="'data:' + item.product.media[0].contentType + ';base64,' + item.product.media[0].base64Data"
             [alt]="item.product.name">
        <div *ngIf="!item.product?.media?.length" class="no-image">No Image</div>
      </div>

      <div class="item-info">
        <p class="item-name" (click)="goToProduct(item.itemId)">
          {{ item.product?.name || ('Product ' + item.itemId) }}
        </p>

        <div class="item-price">
          Price: {{ item.product?.price | currency }}
        </div>

        <div class="item-quantity">
          <label for="qty-{{item.itemId}}">Quantity:</label>
          <input id="qty-{{item.itemId}}"
                 type="number"
                 min="0"
                 [(ngModel)]="item.quantity"
                 (ngModelChange)="updateQuantity(item.itemId, $event)">
        </div>

        <div class="item-total">
          Total: {{ getItemTotal(item) | currency }}
        </div>
      </div>

      <div class="item-actions">
        <button mat-stroked-button color="warn" (click)="removeItem(item.itemId)">
          Remove
        </button>
      </div>

    </div>
  </div>

  <div class="cart-footer" *ngIf="cartItemsWithProducts.length">
    <p class="cart-total">Cart Total: {{ getCartTotal() | currency }}</p>
    <button mat-raised-button color="primary">Checkout</button>
  </div>
</div>
