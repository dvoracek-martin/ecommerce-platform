<div class="product-detail-wrapper">
  <div class="product-detail-container">
    <div class="product-card">
      <!-- Header -->
      <div class="product-header-section" *ngIf="product">
        <div class="product-header-content">
          <!-- Title and Tags Section -->
          <div class="product-title-section">
            <div class="title-content">
              <div class="title-main">
                <h1 class="product-title">{{ product.translatedName }}</h1>
                <div class="title-meta">
                  <div class="product-row">
                    <p class="product-subtitle">{{ 'PRODUCTS.ADMIN_SUBTITLE.CREATE' | translate }}</p>
                    <div class="tags-badges" *ngIf="product.responseTagDTOS?.length">
                      <div class="tags-container" *ngIf="product.responseTagDTOS?.length">
                        <app-tag-badge
                          *ngFor="let tag of product.responseTagDTOS"
                          [tag]="tag"
                          (tagClicked)="onTagClick($event)">
                        </app-tag-badge>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Modern Breadcrumbs -->
      <nav class="modern-breadcrumbs">
        <a class="breadcrumb-item" [routerLink]="['/']">
          <mat-icon class="breadcrumb-icon">home</mat-icon>
          <span class="breadcrumb-text">{{ 'COMMON.HOME' | translate }}</span>
        </a>
        <mat-icon class="breadcrumb-separator">chevron_right</mat-icon>
        <a class="breadcrumb-item" [routerLink]="['/products']">
          <mat-icon class="breadcrumb-icon">inventory</mat-icon>
          <span class="breadcrumb-text">{{ 'COMMON.PRODUCTS' | translate }}</span>
        </a>
        <mat-icon class="breadcrumb-separator">chevron_right</mat-icon>
        <a class="breadcrumb-item" (click)="navigateToCategory()" style="cursor: pointer;">
          <mat-icon class="breadcrumb-icon">category</mat-icon>
          <span class="breadcrumb-text">{{ getCategoryName() }}</span>
        </a>
        <mat-icon class="breadcrumb-separator">chevron_right</mat-icon>
        <span class="breadcrumb-item current">
          <mat-icon class="breadcrumb-icon">inventory_2</mat-icon>
          <span class="breadcrumb-text">{{ product?.translatedName }}</span>
        </span>
      </nav>

      <!-- Loading state -->
      <div *ngIf="loading" class="loading-section">
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
        <div class="loading-text">{{ 'PRODUCTS.LOADING' | translate }}</div>
      </div>

      <!-- Error state -->
      <div *ngIf="error" class="error-section">
        <mat-icon class="error-icon" color="warn">error_outline</mat-icon>
        <div class="error-text">{{ error }}</div>
        <button (click)="backToList()" color="warn" mat-stroked-button>
          <mat-icon>arrow_back</mat-icon>
          {{ 'COMMON.BACK_TO_PRODUCTS' | translate }}
        </button>
      </div>

      <!-- Product Content -->
      <div *ngIf="product" class="product-content">
        <div class="content-layout">
          <!-- Main Content -->
          <div class="main-content">
            <!-- Product Info -->
            <div class="info-section">
              <!-- Description -->
              <div class="info-card" *ngIf="product.translatedDescription">
                <h3>
                  <mat-icon>description</mat-icon>
                  {{ 'PRODUCTS.DESCRIPTION' | translate }}
                </h3>
                <p>{{ product.translatedDescription }}</p>
              </div>

              <!-- Product Details -->
              <div class="info-card" *ngIf="product.weightGrams">
                <h3>
                  <mat-icon>info</mat-icon>
                  {{ 'PRODUCTS.DETAILS' | translate }}
                </h3>
                <div class="detail-grid">
                  <div class="detail-item">
                    <span class="detail-label">{{ 'PRODUCTS.WEIGHT' | translate }}:</span>
                    <span class="detail-value">{{ product.weightGrams }} g</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Sidebar with Purchase and Gallery -->
          <div class="sidebar">

            <!-- Purchase Box -->
            <div class="purchase-card">
              <div class="price-section">
                <span class="price">{{ product.price | swissCurrency }}</span>
              </div>
              <button (click)="addToCart()" class="add-to-cart-btn">
                <mat-icon>add_shopping_cart</mat-icon>
                {{ 'PRODUCTS.ADD_TO_CART' | translate }}
              </button>
            </div>


            <!-- Gallery Box -->
            <app-compact-gallery
              *ngIf="product.media?.length"
              [product]="product"
              [activeSlideIndex]="activeSlideIndex"
              (slideChange)="goToSlide($event)"
              (openGallery)="openGallery()"
              (prevSlide)="prevSlide()"
              (nextSlide)="nextSlide()">
            </app-compact-gallery>

            <!-- Back Button -->
            <button (click)="backToList()" mat-stroked-button class="back-btn">
              <mat-icon>arrow_back</mat-icon>
              {{ 'COMMON.BACK_TO_PRODUCTS' | translate }}
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Full-screen Gallery Modal -->
<app-fullscreen-gallery
  [product]="product"
  [activeSlideIndex]="activeSlideIndex"
  [isOpen]="isGalleryOpen"
  (close)="closeGallery()"
  (slideChange)="goToSlide($event)"
  (prevSlide)="prevSlide()"
  (nextSlide)="nextSlide()">
</app-fullscreen-gallery>
